1. What is image scanning
2. What is Trivy
3. How to install Trivy
4. How to scan Docker images
5. Report generation (JSON / HTML / SARIF)
6. CI/CD integration
7. Why it is critical in production

=============================================

What Does Trivy Scan?

Type	Example
OS Packages	OpenSSL
Language deps	requirements.txt
Secrets	AWS keys
IaC	Terraform
Kubernetes YAML	Misconfigurations


==============================================

What is Docker Image Scanning?

Docker images may contain:

OS vulnerabilities (Ubuntu, Alpine, etc.)

Outdated packages

Application library vulnerabilities (Python, Node, Java)

Hardcoded secrets

Misconfigurations

Image scanning detects these issues before deploying to production.

==============================================

What is Trivy?

Aqua Security developed
Trivy

It is:

Open-source

Fast

Simple CLI

Supports container images, filesystem, Git repos, Kubernetes

==================================================

Install Trivy
On Linux
sudo apt-get update
sudo apt-get install -y wget apt-transport-https gnupg lsb-release

wget -qO - https://aquasecurity.github.io/trivy-repo/deb/public.key | sudo apt-key add -

echo deb https://aquasecurity.github.io/trivy-repo/deb $(lsb_release -sc) main | \
sudo tee /etc/apt/sources.list.d/trivy.list

sudo apt-get update
sudo apt-get install trivy

trivy --version
====================================

Or using Docker:

docker run --rm -v /var/run/docker.sock:/var/run/docker.sock \
aquasec/trivy image nginx
=============================================

Scan Docker Image
Basic scan
trivy image nginx:latest


Output shows:

CRITICAL

HIGH

MEDIUM

LOW vulnerabilities

CVE IDs

Fix versions
=====================

Scan Specific Image
trivy image myapp:1.0

Scan Local Dockerfile directory
trivy fs .


Report Generation

Very important for CI/CD and compliance.

JSON Report
trivy image -f json -o report.json nginx

Table Format (default)
trivy image nginx

HTML Report
  
trivy image -f template \
--template "@contrib/html.tpl" \
-o report.html nginx


===============================================
Show Only HIGH & CRITICAL

trivy image --severity HIGH,CRITICAL nginx:latest

============================================

Fail CI/CD If Vulnerabilities Found
trivy image --exit-code 1 --severity CRITICAL myimage:latest

trivy image --exit-code 1 --severity CRITICAL nginx


If CRITICAL vulnerability found ‚Üí build fails.

CI/CD Integration Example (Jenkins)
stage('Security Scan') {
    steps {
        sh 'trivy image --exit-code 1 --severity HIGH,CRITICAL myapp:latest'
    }
}


Stops insecure image deployment

Shift Left Model (Modern DevSecOps)
Planning ‚Üí Secure Coding ‚Üí Build + Security Scan ‚Üí CI/CD Security ‚Üí Production

Suppose you build a Docker image:

Old Way:

  Build Docker image
  
  Deploy to Kubernetes
  
  Security team scans later
  
  CRITICAL vulnerabilities found

Rollback needed üòµ

  Shift Left Approach:
  
  Developer writes Dockerfile
  
  During CI ‚Üí run Trivy
  
  If CRITICAL found ‚Üí build fails
  
  Fix before merging
  
  No production risk


=============================================

genrate the json report 

trivy image -f json -o report.json nginx:latest

Generate Table Format
trivy image -f table nginx:latest

=================================================

Scan Local Project (Filesystem Scan)
trivy fs .

Great for:

Python requirements.txt

package.json

pom.xml

=====================================================

Scan Dockerfile for Misconfiguration
trivy config Dockerfile

Explain:

Insecure USER root

Missing HEALTHCHECK

Exposed secrets


======================================================

Scan Kubernetes YAML
trivy config k8s-deployment.yaml

Very trending content for DevSecOps

===========================================================

Scan Running Container
trivy image $(docker ps -q)

===============================================================

Scan and Ignore Unfixed Issues
trivy image --ignore-unfixed nginx:latest

==============================================================

Scan Specific Package Type
trivy image --vuln-type os nginx:latest

trivy image --vuln-type library nginx:latest

==========================================================
Generate HTML Report (Team Demo)

trivy image --format template --template "@contrib/html.tpl" -o report.html nginx:latest

  
üí• 9Ô∏è‚É£ Why Image Scanning Is So Important?
1Ô∏è‚É£ Prevent Production Attacks

If image has vulnerable OpenSSL ‚Üí Hacker can exploit.

2Ô∏è‚É£ Supply Chain Security

You might pull:

docker pull python:3.9


But base image may have vulnerabilities.

3Ô∏è‚É£ Compliance Requirements

ISO 27001

SOC2

PCI-DSS

Require vulnerability scanning.

4Ô∏è‚É£ DevSecOps Practice

Security integrated into pipeline.

Shift-left security.

üî• 10Ô∏è‚É£ Real Production Example

Suppose:

Your Django app uses:

Django==2.2


Trivy detects:

CVE-XXXX

Remote Code Execution vulnerability

Solution:

Upgrade:

Django==4.x

üìå 11Ô∏è‚É£ Advanced Trivy Usage
Scan Kubernetes Cluster
trivy k8s cluster

Scan Dockerfile for misconfig
trivy config .

Scan Private Registry
trivy image myregistry.com/myapp:1.0

üî• 12Ô∏è‚É£ Interview Questions (Important)
Q1: Difference between Clair and Trivy?

Trivy:

Faster

Simple

Multi-target scanning

Q2: Can Trivy scan running containers?

trivy image container_id

Q3: How to reduce vulnerabilities?

Use smaller base image (Alpine)

Update packages

Remove unnecessary packages in Multi-stage builds

Best Practices (For Your DevOps Profile)

Since you work with:

CI/CD

You should:

‚úî Scan images before pushing to ECR
‚úî Integrate Trivy in Jenkins
‚úî Fail pipeline on HIGH/CRITICAL
‚úî Generate HTML report artifact
‚úî Upload SARIF to GitHub Security
