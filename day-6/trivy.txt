1ï¸âƒ£ What is image scanning
2ï¸âƒ£ What is Trivy
3ï¸âƒ£ How to install Trivy
4ï¸âƒ£ How to scan Docker images
5ï¸âƒ£ Report generation (JSON / HTML / SARIF)
6ï¸âƒ£ CI/CD integration
7ï¸âƒ£ Why it is critical in production

ğŸ” 1ï¸âƒ£ What is Docker Image Scanning?

Docker images may contain:

OS vulnerabilities (Ubuntu, Alpine, etc.)

Outdated packages

Application library vulnerabilities (Python, Node, Java)

Hardcoded secrets

Misconfigurations

Image scanning detects these issues before deploying to production.

ğŸ” 2ï¸âƒ£ What is Trivy?

Aqua Security developed
Trivy

It is:

Open-source

Fast

Simple CLI

Supports container images, filesystem, Git repos, Kubernetes

ğŸ”¥ 3ï¸âƒ£ Install Trivy
On Linux
sudo apt install wget
wget https://github.com/aquasecurity/trivy/releases/latest/download/trivy_0.50.0_Linux-64bit.deb
sudo dpkg -i trivy_0.50.0_Linux-64bit.deb


Or using Docker:

docker run --rm -v /var/run/docker.sock:/var/run/docker.sock \
aquasec/trivy image nginx

ğŸ³ 4ï¸âƒ£ Scan Docker Image
Basic scan
trivy image nginx:latest


Output shows:

CRITICAL

HIGH

MEDIUM

LOW vulnerabilities

CVE IDs

Fix versions

Scan Specific Image
trivy image myapp:1.0

Scan Local Dockerfile directory
trivy fs .

ğŸ“Š 5ï¸âƒ£ Report Generation

Very important for CI/CD and compliance.

JSON Report
trivy image -f json -o report.json nginx

Table Format (default)
trivy image nginx

HTML Report
  
trivy image -f template \
--template "@contrib/html.tpl" \
-o report.html nginx

SARIF Report (Used in GitHub Security tab)
trivy image -f sarif -o report.sarif nginx


Used in:

GitHub security scanning integration.

ğŸš¨ 6ï¸âƒ£ Fail Build If Vulnerabilities Found

In CI/CD (Very Important ğŸ”¥)

trivy image --exit-code 1 --severity CRITICAL nginx


If CRITICAL vulnerability found â†’ build fails.

ğŸ” 7ï¸âƒ£ CI/CD Integration Example (Jenkins)
stage('Security Scan') {
    steps {
        sh 'trivy image --exit-code 1 --severity HIGH,CRITICAL myapp:latest'
    }
}


âœ” Stops insecure image deployment
âœ” Security Shift Left

ğŸ” 8ï¸âƒ£ What Does Trivy Scan?
Type	Example
OS Packages	OpenSSL
Language deps	requirements.txt
Secrets	AWS keys
IaC	Terraform
Kubernetes YAML	Misconfigurations
  
ğŸ’¥ 9ï¸âƒ£ Why Image Scanning Is So Important?
1ï¸âƒ£ Prevent Production Attacks

If image has vulnerable OpenSSL â†’ Hacker can exploit.

2ï¸âƒ£ Supply Chain Security

You might pull:

docker pull python:3.9


But base image may have vulnerabilities.

3ï¸âƒ£ Compliance Requirements

ISO 27001

SOC2

PCI-DSS

Require vulnerability scanning.

4ï¸âƒ£ DevSecOps Practice

Security integrated into pipeline.

Shift-left security.

ğŸ”¥ 10ï¸âƒ£ Real Production Example

Suppose:

Your Django app uses:

Django==2.2


Trivy detects:

CVE-XXXX

Remote Code Execution vulnerability

Solution:

Upgrade:

Django==4.x

ğŸ“Œ 11ï¸âƒ£ Advanced Trivy Usage
Scan Kubernetes Cluster
trivy k8s cluster

Scan Dockerfile for misconfig
trivy config .

Scan Private Registry
trivy image myregistry.com/myapp:1.0

ğŸ”¥ 12ï¸âƒ£ Interview Questions (Important)
Q1: Difference between Clair and Trivy?

Trivy:

Faster

Simple

Multi-target scanning

Q2: Can Trivy scan running containers?

Yes.

trivy image container_id

Q3: How to reduce vulnerabilities?

Use smaller base image (Alpine)

Update packages

Remove unnecessary packages

Multi-stage builds

ğŸš€ 13ï¸âƒ£ Best Practices (For Your DevOps Profile)

Since you work with:

AWS

Docker

Kubernetes

CI/CD

You should:

âœ” Scan images before pushing to ECR
âœ” Integrate Trivy in Jenkins
âœ” Fail pipeline on HIGH/CRITICAL
âœ” Generate HTML report artifact
âœ” Upload SARIF to GitHub Security
